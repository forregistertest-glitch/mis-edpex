# à¸£à¸°à¸šà¸šà¸¢à¸·à¸™à¸¢à¸±à¸™à¸•à¸±à¸§à¸•à¸™à¹à¸¥à¸° Workflow à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´à¸‚à¹‰à¸­à¸¡à¸¹à¸¥
# Authentication & Data Approval Workflow

| Field | Value |
|:------|:------|
| **Doc ID** | KUVMIS-DOC-008 |
| **Version** | 1.4.0 |
| **Last Updated** | 2026-02-12T00:30:00+07:00 |
| **Author** | KUVMIS Development Team |
| **Status** | Released |

---

## 1. à¸ à¸²à¸à¸£à¸§à¸¡à¸£à¸°à¸šà¸šà¸¢à¸·à¸™à¸¢à¸±à¸™à¸•à¸±à¸§à¸•à¸™ (Authentication)

### 1.1 Authentication Flow
- **Provider**: Google Sign-In via Firebase Auth.
- **Persistence**: `inMemoryPersistence` (User must login every time tab is refreshed or closed for security).
- **Domain Restriction**: Only emails listed in `authorized_users` collection are allowed access.

### 1.2 à¸à¸²à¸£à¸„à¸§à¸šà¸„à¸¸à¸¡à¸ªà¸´à¸—à¸˜à¸´à¹Œ (Email Whitelist)
à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆà¸—à¸¸à¸ Google Account à¸—à¸µà¹ˆà¹€à¸‚à¹‰à¸²à¸£à¸°à¸šà¸šà¹„à¸”à¹‰ â€” à¸•à¹‰à¸­à¸‡à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™ **à¸£à¸²à¸¢à¸Šà¸·à¹ˆà¸­à¸—à¸µà¹ˆà¸­à¸™à¸¸à¸à¸²à¸•** à¸‹à¸¶à¹ˆà¸‡à¹€à¸à¹‡à¸šà¹„à¸§à¹‰à¹ƒà¸™ Firestore collection `authorized_users`

à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹ƒà¸™ Firestore:
```
Collection: authorized_users
Document ID: "nipon.w@ku.th"
{
  email: "nipon.w@ku.th",
  role: "admin",
  name: "à¸™à¸´à¸à¸™à¸˜à¹Œ",
  added_at: "2026-02-10"
}
```

### 1.3 à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸à¸²à¸£ Login
1. User à¸à¸” "Sign in with Google"
2. Google popup â†’ à¹€à¸¥à¸·à¸­à¸ account â†’ à¸¢à¸·à¸™à¸¢à¸±à¸™ 2FA (à¸–à¹‰à¸²à¹€à¸›à¸´à¸”à¹„à¸§à¹‰à¹ƒà¸™ Google)
3. à¸£à¸°à¸šà¸šà¸”à¸¶à¸‡ email à¸¡à¸²à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸à¸±à¸š `authorized_users` à¹ƒà¸™ Firestore
4. âœ… à¸à¸š email â†’ à¹€à¸‚à¹‰à¸²à¸£à¸°à¸šà¸šà¹„à¸”à¹‰ + à¸à¸³à¸«à¸™à¸” role à¸•à¸²à¸¡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥
5. âŒ à¹„à¸¡à¹ˆà¸à¸š â†’ Sign-out à¸—à¸±à¸™à¸—à¸µ + à¹à¸ªà¸”à¸‡à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡ "à¹„à¸¡à¹ˆà¸¡à¸µà¸ªà¸´à¸—à¸˜à¸´à¹Œà¹€à¸‚à¹‰à¸²à¹ƒà¸Šà¹‰à¸‡à¸²à¸™"

### 1.4 Two-Factor Authentication (2FA)
à¸£à¸°à¸šà¸šà¹„à¸”à¹‰ 2FA à¸Ÿà¸£à¸µà¸ˆà¸²à¸ Google â€” à¸–à¹‰à¸²à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¹€à¸›à¸´à¸” 2-Step Verification à¹ƒà¸™ Google Account à¸£à¸°à¸šà¸šà¸ˆà¸°à¸šà¸±à¸‡à¸„à¸±à¸šà¸¢à¸·à¸™à¸¢à¸±à¸™à¸•à¸±à¸§à¸•à¸™ 2 à¸Šà¸±à¹‰à¸™à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´ à¹‚à¸”à¸¢à¹€à¸£à¸²à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡ implement à¹€à¸à¸´à¹ˆà¸¡

---

## 2. à¸£à¸°à¸šà¸š Role (à¸šà¸—à¸šà¸²à¸—)

| Role | à¸ªà¸´à¸—à¸˜à¸´à¹Œ | à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡ |
|------|--------|----------|
| **user** | à¸à¸£à¸­à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥, à¸”à¸¹ Dashboard, à¸¥à¸š/à¹à¸à¹‰à¹€à¸‰à¸à¸²à¸°à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸‚à¸­à¸‡à¸•à¸±à¸§à¹€à¸­à¸‡à¸—à¸µà¹ˆ status = pending | staff@ku.th |
| **reviewer** | à¸—à¸¸à¸à¸­à¸¢à¹ˆà¸²à¸‡à¸—à¸µà¹ˆ user à¸—à¸³à¹„à¸”à¹‰ + Approve/Reject à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸‚à¸­à¸‡à¸—à¸¸à¸à¸„à¸™ + à¹€à¸‚à¹‰à¸²à¹€à¸¡à¸™à¸¹ "à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥" | head@ku.th |
| **admin** | à¸—à¸¸à¸à¸­à¸¢à¹ˆà¸²à¸‡ + à¸ˆà¸±à¸”à¸à¸²à¸£ users + à¹€à¸‚à¹‰à¸² Seed page + à¸¥à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸¸à¸ status + à¹€à¸‚à¹‰à¸²à¹€à¸¡à¸™à¸¹ "à¸ˆà¸±à¸”à¸à¸²à¸£à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰" | nipon.w@ku.th |

### 2.1 Role Badge à¹ƒà¸™ Sidebar âœ…
à¹€à¸¡à¸·à¹ˆà¸­ Login à¹à¸¥à¹‰à¸§ Sidebar à¸ˆà¸°à¹à¸ªà¸”à¸‡ Badge à¸•à¸²à¸¡ Role:
- ğŸ”´ **Admin** â€” badge à¹à¸”à¸‡ à¸à¸£à¹‰à¸­à¸¡à¹„à¸­à¸„à¸­à¸™ Shield
- ğŸŸ¡ **Reviewer** â€” badge à¹€à¸«à¸¥à¸·à¸­à¸‡ à¸à¸£à¹‰à¸­à¸¡à¹„à¸­à¸„à¸­à¸™ UserCheck
- ğŸ”µ **User** â€” badge à¸™à¹‰à¸³à¹€à¸‡à¸´à¸™ à¸à¸£à¹‰à¸­à¸¡à¹„à¸­à¸„à¸­à¸™ User

### 2.2 à¹€à¸¡à¸™à¸¹à¸•à¸²à¸¡ Role âœ…
| à¹€à¸¡à¸™à¸¹ | User | Reviewer | Admin |
|------|:----:|:--------:|:-----:|
| Dashboard | âœ… | âœ… | âœ… |
| à¸«à¸¡à¸§à¸” KPI (Academic, Staff, Hospital, Strategic) | âœ… | âœ… | âœ… |
| à¸à¸£à¸­à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ (Input) | âœ… | âœ… | âœ… |
| à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥ (Review) | âŒ | âœ… | âœ… |
| à¸ˆà¸±à¸”à¸à¸²à¸£à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰ (Admin) | âŒ | âŒ | âœ… |
| Reports / à¹€à¸­à¸à¸ªà¸²à¸£ | âœ… | âœ… | âœ… |

---

## 3. Workflow à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ (Data Approval) âœ…

### 3.1 à¹à¸œà¸™à¸ à¸²à¸ Workflow

```
User à¸à¸£à¸­à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥
  â†’ status: "pending" (à¸£à¸­à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š)
  â†’ submitted_by: email à¸œà¸¹à¹‰à¸à¸£à¸­à¸ (à¸ˆà¸£à¸´à¸‡)

Reviewer/Admin à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š (à¹€à¸¡à¸™à¸¹ "à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥")
  â†’ âœ… Approve â†’ status: "approved" + reviewed_by + reviewed_at
  â†’ âŒ Reject  â†’ status: "rejected" + à¹€à¸«à¸•à¸¸à¸œà¸¥ + reviewed_by + reviewed_at
  â†’ âœï¸ à¸ªà¹ˆà¸‡à¸à¸¥à¸±à¸šà¹à¸à¹‰à¹„à¸‚ â†’ status: "revision_requested" + reviewed_by

User à¹€à¸«à¹‡à¸™à¸£à¸²à¸¢à¸à¸²à¸£à¸—à¸µà¹ˆà¸–à¸¹à¸à¸›à¸à¸´à¹€à¸ªà¸˜/à¸ªà¹ˆà¸‡à¸à¸¥à¸±à¸š
  â†’ à¹à¸à¹‰à¹„à¸‚à¹à¸¥à¹‰à¸§à¸ªà¹ˆà¸‡à¹ƒà¸«à¸¡à¹ˆ â†’ status: "pending"
```

### 3.2 à¸ªà¸–à¸²à¸™à¸°à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ (Entry Status)

| Status | à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢ (TH) | à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢ (EN) | à¸ªà¸µ |
|--------|---------------|---------------|-----|
| `pending` | à¸£à¸­à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š | Pending Review | ğŸŸ¡ à¹€à¸«à¸¥à¸·à¸­à¸‡ |
| `approved` | à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´à¹à¸¥à¹‰à¸§ | Approved | ğŸŸ¢ à¹€à¸‚à¸µà¸¢à¸§ |
| `rejected` | à¸›à¸à¸´à¹€à¸ªà¸˜ | Rejected | ğŸ”´ à¹à¸”à¸‡ |
| `revision_requested` | à¸ªà¹ˆà¸‡à¸à¸¥à¸±à¸šà¹à¸à¹‰à¹„à¸‚ | Revision Requested | ğŸŸ  à¸ªà¹‰à¸¡ |
| `deleted` | à¸¥à¸šà¹à¸¥à¹‰à¸§ (soft delete) | Deleted | âš« à¹€à¸—à¸² |

### 3.3 à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¹€à¸à¹‡à¸šà¹€à¸¡à¸·à¹ˆà¸­ Review âœ…
à¹€à¸¡à¸·à¹ˆà¸­ Reviewer Approve/Reject à¸ˆà¸°à¹€à¸à¸´à¹ˆà¸¡à¸Ÿà¸´à¸¥à¸”à¹Œà¹ƒà¸™ Firestore:
- `reviewed_by`: email à¸‚à¸­à¸‡ Reviewer
- `reviewed_at`: timestamp à¸—à¸µà¹ˆ review
- `rejection_reason`: à¹€à¸«à¸•à¸¸à¸œà¸¥à¸—à¸µà¹ˆà¸›à¸à¸´à¹€à¸ªà¸˜ (à¸à¸£à¸“à¸µ Reject)

---

## 4. à¸à¸²à¸£à¸¥à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥ (Soft Delete) âœ…

à¸£à¸°à¸šà¸šà¹ƒà¸Šà¹‰ **Soft Delete** â€” à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸°à¹„à¸¡à¹ˆà¸–à¸¹à¸à¸¥à¸šà¸­à¸­à¸à¸ˆà¸²à¸ Firestore à¸ˆà¸£à¸´à¸‡ à¹à¸•à¹ˆà¸ˆà¸°à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™ status à¹€à¸›à¹‡à¸™ `"deleted"` à¹€à¸à¸·à¹ˆà¸­à¹ƒà¸«à¹‰à¸ªà¸²à¸¡à¸²à¸£à¸–à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸¢à¹‰à¸­à¸™à¸à¸¥à¸±à¸šà¹„à¸”à¹‰

### 4.1 à¸à¸à¸à¸²à¸£à¸¥à¸š

| Role | à¸¥à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥ pending à¸‚à¸­à¸‡à¸•à¸±à¸§à¹€à¸­à¸‡ | à¸¥à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥ approved | à¸¥à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸‚à¸­à¸‡à¸„à¸™à¸­à¸·à¹ˆà¸™ |
|------|:-:|:-:|:-:|
| **user** | âœ… | âŒ | âŒ |
| **reviewer** | âœ… | âŒ | âŒ |
| **admin** | âœ… | âœ… | âœ… |

### 4.2 à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¹€à¸à¹‡à¸šà¹€à¸à¸´à¹ˆà¸¡à¹€à¸¡à¸·à¹ˆà¸­à¸¥à¸š âœ…
à¹€à¸¡à¸·à¹ˆà¸­ soft delete à¸ˆà¸°à¹€à¸à¸´à¹ˆà¸¡à¸Ÿà¸´à¸¥à¸”à¹Œ:
- `deleted_at`: timestamp à¸—à¸µà¹ˆà¸¥à¸š
- `deleted_by`: email à¸‚à¸­à¸‡à¸œà¸¹à¹‰à¸¥à¸š
- `previous_status`: status à¸à¹ˆà¸­à¸™à¸¥à¸š (à¹€à¸à¸·à¹ˆà¸­ restore à¹„à¸”à¹‰)

---

## 5. Admin Panel: à¸ˆà¸±à¸”à¸à¸²à¸£à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¸‡à¸²à¸™ âœ…

à¹€à¸¡à¸™à¸¹ "à¸ˆà¸±à¸”à¸à¸²à¸£à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰" (à¹€à¸‰à¸à¸²à¸° Admin) à¸Šà¹ˆà¸§à¸¢à¹ƒà¸«à¹‰à¸ˆà¸±à¸”à¸à¸²à¸£ authorized_users à¹„à¸”à¹‰à¹‚à¸”à¸¢à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¹€à¸‚à¹‰à¸² Firebase Console

### 5.1 à¸Ÿà¸µà¹€à¸ˆà¸­à¸£à¹Œ
- ğŸ“‹ **à¸”à¸¹à¸£à¸²à¸¢à¸Šà¸·à¹ˆà¸­à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰** â€” à¸•à¸²à¸£à¸²à¸‡ Email, à¸Šà¸·à¹ˆà¸­, Role, à¸§à¸±à¸™à¸—à¸µà¹ˆà¹€à¸à¸´à¹ˆà¸¡
- â• **à¹€à¸à¸´à¹ˆà¸¡à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¹ƒà¸«à¸¡à¹ˆ** â€” à¸à¸£à¸­à¸ Email, à¸Šà¸·à¹ˆà¸­, à¹€à¸¥à¸·à¸­à¸ Role
- ğŸ”„ **à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™ Role** â€” Dropdown à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™ Role à¹„à¸”à¹‰à¸—à¸±à¸™à¸—à¸µ
- ğŸ—‘ï¸ **à¸¥à¸šà¸œà¸¹à¹‰à¹ƒà¸Šà¹‰** â€” à¸¥à¸šà¸­à¸­à¸à¸ˆà¸²à¸à¸£à¸°à¸šà¸š (à¸›à¹‰à¸­à¸‡à¸à¸±à¸™à¹„à¸¡à¹ˆà¹ƒà¸«à¹‰à¸¥à¸šà¸•à¸±à¸§à¹€à¸­à¸‡)

### 5.2 à¸‚à¹‰à¸­à¸ˆà¸³à¸à¸±à¸”à¸”à¹‰à¸²à¸™à¸„à¸§à¸²à¸¡à¸›à¸¥à¸­à¸”à¸ à¸±à¸¢
- à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¸¥à¸šà¸•à¸±à¸§à¹€à¸­à¸‡à¹„à¸”à¹‰
- à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™ Role à¸‚à¸­à¸‡à¸•à¸±à¸§à¹€à¸­à¸‡à¹„à¸”à¹‰
- à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¸—à¸µà¹ˆà¸–à¸¹à¸à¸¥à¸šà¸ˆà¸°à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¹€à¸‚à¹‰à¸²à¸£à¸°à¸šà¸šà¹„à¸”à¹‰à¸—à¸±à¸™à¸—à¸µ

---

## 6. à¸à¸²à¸£à¸›à¹‰à¸­à¸‡à¸à¸±à¸™à¸«à¸™à¹‰à¸² Seed âœ…

à¸«à¸™à¹‰à¸² `/seed` à¹€à¸›à¹‡à¸™à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸¡à¸·à¸­à¸ªà¸³à¸«à¸£à¸±à¸š admin à¹ƒà¸Šà¹‰ Seed à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™

- à¸•à¹‰à¸­à¸‡ login à¸à¹ˆà¸­à¸™à¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡
- à¹€à¸‰à¸à¸²à¸° role = **admin** à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™à¸—à¸µà¹ˆà¹€à¸‚à¹‰à¸²à¹„à¸”à¹‰
- à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¸—à¸±à¹ˆà¸§à¹„à¸›à¸ˆà¸°à¹€à¸«à¹‡à¸™à¸«à¸™à¹‰à¸² "à¹„à¸¡à¹ˆà¸¡à¸µà¸ªà¸´à¸—à¸˜à¸´à¹Œà¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡"

> **à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸:** à¸«à¸™à¹‰à¸² Seed à¸ˆà¸°à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¹€à¸‰à¸à¸²à¸°à¸Šà¹ˆà¸§à¸‡à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™à¸£à¸°à¸šà¸š à¸«à¸¥à¸±à¸‡à¸ˆà¸²à¸ User à¹€à¸£à¸´à¹ˆà¸¡à¸à¸£à¸­à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸£à¸´à¸‡à¹à¸¥à¹‰à¸§ à¸ˆà¸°à¸¢à¸à¹€à¸¥à¸´à¸à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¸«à¸™à¹‰à¸²à¸™à¸µà¹‰

---

## 7. Error Boundary âœ…

à¸£à¸°à¸šà¸šà¸¡à¸µ Error Boundary à¹€à¸à¸·à¹ˆà¸­à¸£à¸­à¸‡à¸£à¸±à¸šà¸à¸£à¸“à¸µà¸—à¸µà¹ˆ Firebase à¸¥à¹ˆà¸¡à¸«à¸£à¸·à¸­à¹€à¸à¸´à¸”à¸‚à¹‰à¸­à¸œà¸´à¸”à¸à¸¥à¸²à¸”:

- **error.tsx**: à¸ˆà¸±à¸š error à¹ƒà¸™à¸«à¸™à¹‰à¸²à¹€à¸à¸ˆ â†’ à¹à¸ªà¸”à¸‡à¸«à¸™à¹‰à¸² error à¸ªà¸§à¸¢à¸‡à¸²à¸¡à¹à¸—à¸™à¸—à¸µà¹ˆà¸ˆà¸°à¹à¸ªà¸”à¸‡à¸«à¸™à¹‰à¸²à¸§à¹ˆà¸²à¸‡
- **global-error.tsx**: à¸ˆà¸±à¸š error à¸£à¸°à¸”à¸±à¸š layout â†’ à¸›à¹‰à¸­à¸‡à¸à¸±à¸™à¸«à¸™à¹‰à¸²à¹€à¸§à¹‡à¸šà¸„à¹‰à¸²à¸‡à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”
- à¸¡à¸µà¸›à¸¸à¹ˆà¸¡ "à¸¥à¸­à¸‡à¹ƒà¸«à¸¡à¹ˆ" à¹à¸¥à¸° "à¸à¸¥à¸±à¸šà¸«à¸™à¹‰à¸²à¸«à¸¥à¸±à¸"

---

## 8. à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¹„à¸Ÿà¸¥à¹Œà¸—à¸µà¹ˆà¹€à¸à¸µà¹ˆà¸¢à¸§à¸‚à¹‰à¸­à¸‡

```
src/
â”œâ”€â”€ contexts/
â”‚   â””â”€â”€ AuthContext.tsx              â† React Context à¸ªà¸³à¸«à¸£à¸±à¸š Auth
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ LoginPage.tsx                â† à¸«à¸™à¹‰à¸² Login
â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â”œâ”€â”€ Sidebar.tsx              â† à¹€à¸¡à¸™à¸¹ + Role badge + à¹€à¸¡à¸™à¸¹à¸•à¸²à¸¡ Role
â”‚   â”‚   â”œâ”€â”€ Header.tsx               â† à¸Šà¸·à¹ˆà¸­/à¸£à¸¹à¸› user à¸ˆà¸£à¸´à¸‡
â”‚   â”‚   â”œâ”€â”€ ReviewerDashboard.tsx    â† à¸«à¸™à¹‰à¸² Approve/Reject (B2)
â”‚   â”‚   â””â”€â”€ AdminPanel.tsx           â† à¸«à¸™à¹‰à¸²à¸ˆà¸±à¸”à¸à¸²à¸£à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰ (B4)
â”‚   â””â”€â”€ kpi-input/                   â† Sub-components
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ layout.tsx                   â† Wrap AuthProvider
â”‚   â”œâ”€â”€ page.tsx                     â† Login gate + à¸—à¸¸à¸ tabs
â”‚   â”œâ”€â”€ error.tsx                    â† Error Boundary
â”‚   â”œâ”€â”€ global-error.tsx             â† Global Error Boundary
â”‚   â””â”€â”€ seed/page.tsx                â† Auth guard (admin only)
â””â”€â”€ lib/
    â”œâ”€â”€ firebase.ts                  â† Firebase config
    â””â”€â”€ data-service.ts              â† CRUD + review + soft delete + admin
```

---

## 9. Firestore Collections

| Collection | à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢ |
|------------|----------|
| `kpi_master` | à¸£à¸²à¸¢à¸à¸²à¸£ KPI à¸«à¸¥à¸±à¸ (61 KPIs) |
| `kpi_entries` | à¸„à¹ˆà¸² KPI à¸—à¸µà¹ˆà¸à¸£à¸­à¸ (à¸¡à¸µ status, review, delete fields) |
| `authorized_users` | à¸£à¸²à¸¢à¸Šà¸·à¹ˆà¸­ email à¸—à¸µà¹ˆà¸¡à¸µà¸ªà¸´à¸—à¸˜à¸´à¹Œ + role |
| `login_logs` | à¸šà¸±à¸™à¸—à¸¶à¸à¸à¸²à¸£à¹€à¸‚à¹‰à¸²à¹ƒà¸Šà¹‰à¸‡à¸²à¸™ (email, IP, user agent, geo location) |

---

## 10. à¹à¸œà¸™à¸à¸²à¸£à¸”à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£ (Implementation Phases)

### à¹€à¸Ÿà¸ª A âœ… (à¸ªà¸³à¹€à¸£à¹‡à¸ˆ)
- [x] Rec 1: à¹à¸à¹‰ metadata
- [x] Rec 2: à¹à¸¢à¸ page.tsx â†’ 5 components
- [x] Rec 3: à¹à¸¢à¸ KpiInputForm.tsx â†’ 4 sub-components
- [x] Rec 4: Firebase Auth + Google Sign-In + Email Whitelist
- [x] Rec 5: à¸›à¹‰à¸­à¸‡à¸à¸±à¸™à¸«à¸™à¹‰à¸² Seed (admin only)
- [x] Rec 6: Error Boundary

### à¹€à¸Ÿà¸ª B âœ… (à¸ªà¸³à¹€à¸£à¹‡à¸ˆ)
- [x] B1: Role-based UI + à¹à¸à¹‰ submitted_by à¹€à¸›à¹‡à¸™ email à¸ˆà¸£à¸´à¸‡
- [x] B2: Approval Workflow (Reviewer Dashboard)
- [x] B3: Soft Delete à¸à¸£à¹‰à¸­à¸¡ Audit Log
- [x] B4: Admin Panel à¸ˆà¸±à¸”à¸à¸²à¸£à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¸œà¹ˆà¸²à¸™à¸«à¸™à¹‰à¸²à¹€à¸§à¹‡à¸š

---

*à¹€à¸­à¸à¸ªà¸²à¸£à¸™à¸µà¹‰à¸›à¸£à¸±à¸šà¸›à¸£à¸¸à¸‡à¸¥à¹ˆà¸²à¸ªà¸¸à¸”à¹€à¸¡à¸·à¹ˆà¸­ 12 à¸.à¸. 2569 â€” KUVMIS v1.4*
